from flask import Flask, render_template_string, send_from_directory
import os

app = Flask(__name__)
app.config['UPLOAD_FOLDER'] = os.path.join(os.path.dirname(__file__), 'static')
app.config['CV_PATH'] = os.path.join(app.config['UPLOAD_FOLDER'], 'cv')
os.makedirs(app.config['CV_PATH'], exist_ok=True)

PROFILE = {
    "name": "Rejina Phuyal",
    "location": "Kathmandu, Nepal",
    "contact": "+977 9863520151 | phuyalrejina101@gmail.com",
    "social": [
        {"label": "LinkedIn", "url": "https://linkedin.com"},
        {"label": "GitHub", "url": "https://github.com"},
        {"label": "Medium", "url": "https://medium.com"}
    ],
    "objective": (
        "To build a long-term career in cybersecurity by developing secure, resilient systems and advancing threat prevention strategies. "
        "I aim to become a cybersecurity leader focused on protecting critical infrastructure, promoting ethical innovation, and fostering awareness through research and mentorship. "
        "With a strong commitment to continuous learning, I strive to stay ahead of evolving threats and contribute to shaping global security standards."
    ),
    "education": [
        {"degree": "BSc. (Hons.) Computer Networking and IT Security", "institution": "Islington College, London Metropolitan University", "year": "2023–Present"},
        {"degree": "School Leaving Certificate (SLC)", "institution": "SANN International College", "year": "2019–2021"},
        {"degree": "Secondary Education Examination (SEE)", "institution": "Shree Deaurali Higher Secondary School", "year": "2018"}
    ],
    "technical_skills": ["Ethical Hacking", "CIA Triad", "Risk Management", "Access Control", "TCP/IP", "VPN", "DNS", "Firewalls", "AWS", "Virtualization", "Packet Tracer", "Kali Linux", "Encryption", "Cryptography"],
    "soft_skills": ["Communication", "Presentation", "Project Management", "Time Management", "Leadership", "Teamwork", "Problem Solving", "Critical Thinking"],
    "projects": [
        {"title": "Land Rental Service (Python Project)", "description": "Developed a Python-based land rental management application enabling customers to rent and return land parcels."},
        {"title": "Teacher Management System with GUI", "description": "Designed a two-phase teacher management system emphasizing object-oriented concepts and GUI for data entry."},
        {"title": "Online Printer Product Showcase", "description": "Designed a user-friendly website to display printer products and services effectively."},
        {"title": "Cryptography Research: Bit-Shift XOR Caesar Cipher", "description": "Improved the classic Caesar cipher combining XOR and bitwise shifts."},
        {"title": "IoT Project - Water Level Monitoring System", "description": "Built IoT solution to track water levels with automated alerts."},
        {"title": "Password Strength Checker", "description": "Command-line tool evaluating password strength and secure generator."},
        {"title": "Phishing Awareness Simulation Tool", "description": "Simulated phishing environment to educate users on phishing tactics."}
    ],
    "certifications": ["EC-Council – Cybersecurity, Ethical Hacking Essentials, Android Bug Bounty Hunting", "AWS Academy - Cloud Foundations, Security, Architecting, Operations", "ISO/IEC 27001:2022 Lead Auditor"],
    "achievements": ["Recognized as a Class STAR for dedication, curiosity, and teamwork"],
    "reference": "Mr. Prayagraj Koirala - Lecturer, Security researcher - Islington College, prayagraj.koirala@islingtoncollege.edu.np",
    "cv_name": "cv.pdf"
}

BASE_TMPL = """
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ profile.name }} - Portfolio</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-5xl mx-auto p-6 space-y-6">
    <header class="text-center">
      <h1 class="text-3xl font-bold">{{ profile.name }}</h1>
      <p class="text-indigo-600">{{ profile.location }} | {{ profile.contact }}</p>
      <div class="flex justify-center gap-4 mt-2">
        {% for s in profile.social %}
          <a class="underline text-blue-600" href="{{ s.url }}" target="_blank">{{ s.label }}</a>
        {% endfor %}
      </div>
    </header>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Career Objective</h2>
      <p>{{ profile.objective }}</p>
    </section>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Education</h2>
      <ul class="list-disc ml-6">
        {% for ed in profile.education %}
          <li>{{ ed.degree }} - {{ ed.institution }} ({{ ed.year }})</li>
        {% endfor %}
      </ul>
    </section>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Technical Skills</h2>
      <div class="flex flex-wrap gap-2">
        {% for skill in profile.technical_skills %}
          <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm">{{ skill }}</span>
        {% endfor %}
      </div>
    </section>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Projects</h2>
      <ul class="list-disc ml-6">
        {% for project in profile.projects %}
          <li><strong>{{ project.title }}</strong>: {{ project.description }}</li>
        {% endfor %}
      </ul>
    </section>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Certifications</h2>
      <ul class="list-disc ml-6">
        {% for cert in profile.certifications %}
          <li>{{ cert }}</li>
        {% endfor %}
      </ul>
    </section>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Achievements</h2>
      <ul class="list-disc ml-6">
        {% for a in profile.achievements %}
          <li>{{ a }}</li>
        {% endfor %}
      </ul>
    </section>

    <section class="bg-white p-6 rounded-xl shadow">
      <h2 class="text-2xl font-semibold mb-2">Reference</h2>
      <p>{{ profile.reference }}</p>
    </section>

    <section class="bg-white p-6 rounded-xl shadow text-center">
      <a class="text-indigo-600 underline" href="{{ url_for('cv') }}">Download CV</a>
    </section>
  </div>
</body>
</html>
"""

@app.route('/')
def home():
    return render_template_string(BASE_TMPL, profile=PROFILE)

@app.route('/cv')
def cv():
    cv_dir = app.config['CV_PATH']
    fpath = os.path.join(cv_dir, PROFILE['cv_name'])
    if os.path.exists(fpath):
        return send_from_directory(cv_dir, PROFILE['cv_name'], as_attachment=False)
    return "CV not found. Please place cv.pdf in static/cv/ folder.", 404

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)

